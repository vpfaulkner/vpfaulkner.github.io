<!DOCTYPE html>
<html lang="en">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">

  <meta http-equiv='Content-Type' content='text/html; charset=utf-8' />
  
  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Beware of Class Methods in Ruby &middot; SimpleObjects
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="http://vpfaulkner.github.io/public/css/poole.css">
  <link rel="stylesheet" href="http://vpfaulkner.github.io/public/css/syntax.css">
  <link href='http://fonts.googleapis.com/css?family=Lora' rel='stylesheet'
  type='text/css'>

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://vpfaulkner.github.io/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="http://vpfaulkner.github.io/public/favicon.ico">
  <link rel="stylesheet" href="/public/font-awesome-4.3.0/css/font-awesome.min.css">

  <!-- RSS -->
  <link rel="alternate" type="application/atom+xml" title="SimpleObjects" href="http://vpfaulkner.github.io/atom.xml">
</head>


  <body>


    <div class="container content">
      <header class="masthead">
        <h3 class="masthead-title">
          <a href="http://vpfaulkner.github.io/" title="Home">SimpleObjects</a>

          
             &nbsp;&nbsp;&nbsp;
             <small><a href="/about_me">About Me</a></small>
          
             &nbsp;&nbsp;&nbsp;
             <small><a href="/playbook">Playbook</a></small>
          
             &nbsp;&nbsp;&nbsp;
             <small><a href="/archive">Archive</a></small>
          

        </h3>
      </header>

      <main>
        <article class="post">
  <h1 class="post-title">Beware of Class Methods in Ruby</h1>
  <time datetime="2015-03-06T00:00:00-05:00" class="page-date">06 Mar 2015</time>
  <p>It is so easy to resort to class methods in Ruby. The behavior you are trying to implement seems to be stateless and writing a class method just seems easier.</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">FileCompressor</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">compress</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="c1"># compressing...</span>
  <span class="k">end</span>

<span class="k">end</span></code></pre></div>

<p>You think to yourself here: the idea of state does not seem that attractive here. This compression should be completely stateless as the only needed in our case is what we are passing in as its argument, the file.</p>

<p>However, let’s say your compression logic begins to grow a little bit:</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">FileCompressor</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">compress</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="n">determine_file_type</span>
    <span class="c1"># compressing...</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">determine_file_type</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="c1"># determining...</span>
  <span class="k">end</span>

<span class="k">end</span></code></pre></div>

<p>OK, no big deal right? Well, suddenly the complexity of your compression logic is growing and each individual method must use only its argument(s) as context. You are navigating a slippery slope here that will make your code not only harder to read and write but also more resistant to refactoring. The key idea is that that with each addition of behavior you add via a new method your class is becoming more and more state-like yet it has no way to store state because you never instantiated it. Your code is becoming more and more procedural and resisting that natural advantages offered by an object-oriented design. At this point I would recommend rethinking your class:</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">FileCompressor</span>

  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="vi">@file</span> <span class="o">=</span> <span class="n">file</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">compress</span>
    <span class="n">determine_file_type</span>
    <span class="c1"># compressing...</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">determine_file_type</span>
    <span class="c1"># determining...</span>
  <span class="k">end</span>

<span class="k">end</span></code></pre></div>

<p>This design rethink will give you a more natural way to accommodate change in behavior and prevent class method “feature envy” here.</p>

</article>

<aside class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="http://vpfaulkner.github.io//2015/05/01/benchmarking-in-ruby/">
            Benchmarking in Ruby
            <small><time datetime="2015-05-01T00:00:00-04:00">01 May 2015</time></small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="http://vpfaulkner.github.io//2015/04/20/the-law-of-demeter/">
            The Law of Demeter
            <small><time datetime="2015-04-20T00:00:00-04:00">20 Apr 2015</time></small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="http://vpfaulkner.github.io//2015/04/17/what-is-the-enumerable-module/">
            What is the Enumerable Module in Ruby?
            <small><time datetime="2015-04-17T00:00:00-04:00">17 Apr 2015</time></small>
          </a>
        </h3>
      </li>
    
  </ul>
</aside>

        

      </main>

      <footer class="footer">
        <small>
          &copy; <time datetime="2015-05-01T08:38:04-04:00">2015</time>. All rights reserved.
        </small>
      </footer>
    </div>

  </body>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-60674340-1', 'auto');
    ga('send', 'pageview');

</script>

</html>
